{
  "kind": "build_request",
  "title": "Fix ckBTC wallet address generation",
  "projectName": "Infinity Wallet",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Fix the Principal serialization issue in useCkBtcDepositAddress hook where the Principal is being sent as a JSON object {\"__principal__\":\"...\"} instead of a proper Candid Principal type when calling the ckBTC minter's get_btc_address method",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-ckbtc-fix"
        ],
        "quotes": [
          "why is not btc wallet generating?"
        ]
      },
      "acceptanceCriteria": [
        "The ckBTC minter receives a properly formatted Candid Account type with a valid Principal",
        "Bitcoin deposit addresses are successfully generated when users navigate to the Receive page",
        "The 'Invalid opt principal argument' error no longer appears in the console",
        "Generated Bitcoin addresses are displayed correctly in the ReceivePage component"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Fix the Principal serialization issue in useCkBtcDepositStatus hook where the Principal is being sent as a JSON object instead of a proper Candid Principal type when calling the ckBTC minter's update_balance method",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-ckbtc-fix"
        ],
        "quotes": [
          "why is not btc wallet generating?"
        ]
      },
      "acceptanceCriteria": [
        "The update_balance method successfully processes deposit status checks",
        "Pending Bitcoin deposits are correctly detected and displayed in the BitcoinDepositStatus component",
        "The deposit status polling works without Principal encoding errors"
      ]
    }
  ],
  "constraints": [
    "Do not modify the ckBTC minter canister ID or other ledger configurations",
    "Preserve the existing authentication flow using Internet Identity",
    "Maintain the current UI structure and component hierarchy",
    "Keep the existing hook architecture and React Query patterns"
  ],
  "nonGoals": [
    "Adding new token types or blockchain integrations",
    "Modifying the backend Motoko actor",
    "Changing the UI design or styling",
    "Adding additional Bitcoin-related features beyond fixing address generation"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}